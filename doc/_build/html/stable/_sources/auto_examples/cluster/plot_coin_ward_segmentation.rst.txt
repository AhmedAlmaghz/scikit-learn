
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/cluster/plot_coin_ward_segmentation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_cluster_plot_coin_ward_segmentation.py>`
        to download the full example code. or to run this example in your browser via JupyterLite or Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_cluster_plot_coin_ward_segmentation.py:


======================================================================
عرض توضيحي لتجميع هرمي منظم على صورة عملات معدنية
======================================================================

احسب تجزئة صورة ثنائية الأبعاد باستخدام التجميع الهرمي. التجميع مقيد مكانيًا لضمان أن تكون كل منطقة مجزأة قطعة واحدة.

.. GENERATED FROM PYTHON SOURCE LINES 8-11

.. code-block:: Python

    # المؤلفون: مطوري سكايلرن
    # معرف الترخيص: BSD-3-Clause








.. GENERATED FROM PYTHON SOURCE LINES 12-14

توليد البيانات
-------------

.. GENERATED FROM PYTHON SOURCE LINES 14-19

.. code-block:: Python


    from skimage.data import coins

    orig_coins = coins()








.. GENERATED FROM PYTHON SOURCE LINES 20-23

تغيير حجمها إلى 20% من الحجم الأصلي لتسريع المعالجة
تطبيق مرشح غاوسي للتنعيم قبل التغيير إلى حجم أصغر
يقلل من آثار التحجيم.

.. GENERATED FROM PYTHON SOURCE LINES 23-38

.. code-block:: Python


    import numpy as np
    from scipy.ndimage import gaussian_filter
    from skimage.transform import rescale

    smoothened_coins = gaussian_filter(orig_coins, sigma=2)
    rescaled_coins = rescale(
        smoothened_coins,
        0.2,
        mode="reflect",
        anti_aliasing=False,
    )

    X = np.reshape(rescaled_coins, (-1, 1))








.. GENERATED FROM PYTHON SOURCE LINES 39-43

تحديد بنية البيانات
----------------------------

البكسلات متصلة بجيرانها.

.. GENERATED FROM PYTHON SOURCE LINES 43-48

.. code-block:: Python


    from sklearn.feature_extraction.image import grid_to_graph

    connectivity = grid_to_graph(*rescaled_coins.shape)








.. GENERATED FROM PYTHON SOURCE LINES 49-51

حساب التجميع
------------------

.. GENERATED FROM PYTHON SOURCE LINES 51-68

.. code-block:: Python


    import time as time

    from sklearn.cluster import AgglomerativeClustering

    print("Compute structured hierarchical clustering...")
    st = time.time()
    n_clusters = 27  # number of regions
    ward = AgglomerativeClustering(
        n_clusters=n_clusters, linkage="ward", connectivity=connectivity
    )
    ward.fit(X)
    label = np.reshape(ward.labels_, rescaled_coins.shape)
    print(f"Elapsed time: {time.time() - st:.3f}s")
    print(f"Number of pixels: {label.size}")
    print(f"Number of clusters: {np.unique(label).size}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Compute structured hierarchical clustering...
    Elapsed time: 0.177s
    Number of pixels: 4697
    Number of clusters: 27




.. GENERATED FROM PYTHON SOURCE LINES 69-75

عرض النتائج على صورة
----------------------------

التجميع التجميعي قادر على تجزئة كل عملة معدنية، ولكن كان علينا
استخدام "n_cluster" أكبر من عدد العملات المعدنية لأن التجزئة
تجد منطقة كبيرة في الخلفية.

.. GENERATED FROM PYTHON SOURCE LINES 75-89

.. code-block:: Python


    import matplotlib.pyplot as plt

    plt.figure(figsize=(5, 5))
    plt.imshow(rescaled_coins, cmap=plt.cm.gray)
    for l in range(n_clusters):
        plt.contour(
            label == l,
            colors=[
                plt.cm.nipy_spectral(l / float(n_clusters)),
            ],
        )
    plt.axis("off")
    plt.show()



.. image-sg:: /auto_examples/cluster/images/sphx_glr_plot_coin_ward_segmentation_001.png
   :alt: plot coin ward segmentation
   :srcset: /auto_examples/cluster/images/sphx_glr_plot_coin_ward_segmentation_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.324 seconds)


.. _sphx_glr_download_auto_examples_cluster_plot_coin_ward_segmentation.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/scikit-learn/scikit-learn/main?urlpath=lab/tree/notebooks/auto_examples/cluster/plot_coin_ward_segmentation.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: lite-badge

      .. image:: images/jupyterlite_badge_logo.svg
        :target: ../../lite/lab/index.html?path=auto_examples/cluster/plot_coin_ward_segmentation.ipynb
        :alt: Launch JupyterLite
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_coin_ward_segmentation.ipynb <plot_coin_ward_segmentation.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_coin_ward_segmentation.py <plot_coin_ward_segmentation.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_coin_ward_segmentation.zip <plot_coin_ward_segmentation.zip>`


.. include:: plot_coin_ward_segmentation.recommendations


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
