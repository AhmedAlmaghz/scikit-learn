
<!DOCTYPE html>


<html lang="ar" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="كيفية التحسين من أجل السرعة" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://scikit-learn/stable/developers/performance.html" />
<meta property="og:site_name" content="scikit-learn" />
<meta property="og:description" content="يقدم ما يلي بعض الإرشادات العملية لمساعدتك في كتابة تعليمات برمجية فعالة لمشروع scikit-learn. Python أو Cython أو C/C++؟: بشكل عام، يؤكد مشروع scikit-learn على قابلية قراءة شفرة المصدر لتسهيل على م..." />
<meta property="og:image" content="https://scikit-learn.org/stable/_static/scikit-learn-logo-small.png" />
<meta property="og:image:alt" content="scikit-learn" />
<meta name="description" content="يقدم ما يلي بعض الإرشادات العملية لمساعدتك في كتابة تعليمات برمجية فعالة لمشروع scikit-learn. Python أو Cython أو C/C++؟: بشكل عام، يؤكد مشروع scikit-learn على قابلية قراءة شفرة المصدر لتسهيل على م..." />

    <title>كيفية التحسين من أجل السرعة &#8212; scikit-learn 1.6.dev0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyterlite_sphinx.css?v=ca70e7f1" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/colors.css?v=cc94ab7d" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/custom.css?v=85b0813d" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=3cd28d06"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=97f0b27d"></script>
    <script src="../_static/jupyterlite_sphinx.js?v=d6bdf5f8"></script>
    <script src="../_static/translations.js?v=87cb2081"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script data-domain="scikit-learn.org" defer="defer" src="https://views.scientific-python.org/js/script.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'developers/performance';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.0';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scikit-learn.org/dev/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.6.dev0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <script src="../_static/scripts/dropdown.js?v=e2048168"></script>
    <script src="../_static/scripts/version-switcher.js?v=a6dd8357"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="بحث" href="../search.html" />
    <link rel="next" title="أفضل ممارسات Cython والاتفاقيات والمعرفة" href="cython.html" />
    <link rel="prev" title="أدوات مساعدة للمطورين" href="utilities.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="ar"/>
  <meta name="docsearch:version" content="1.6" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/scikit-learn-logo-small.png" class="logo__image only-light" alt="scikit-learn homepage"/>
    <img src="../_static/scikit-learn-logo-small.png" class="logo__image only-dark pst-js-only" alt="scikit-learn homepage"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    دليل المستخدم
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blog.scikit-learn.org/">
    Community
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../getting_started.html">
    البدء
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../whats_new.html">
    Release History
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="index.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../support.html">
    الدعم الفني
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../related_projects.html">
    مشاريع ذات علاقة
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
    Roadmap
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../governance.html">
    Governance
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../about.html">
    من نحن
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="بحث" aria-label="بحث" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-learn/scikit-learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="بحث" aria-label="بحث" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide.html">
    دليل المستخدم
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://blog.scikit-learn.org/">
    Community
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started.html">
    البدء
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../whats_new.html">
    Release History
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../glossary.html">
    Glossary
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../support.html">
    الدعم الفني
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../related_projects.html">
    مشاريع ذات علاقة
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../roadmap.html">
    Roadmap
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../governance.html">
    Governance
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    من نحن
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-learn/scikit-learn" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contributing.html">المساهمة</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimal_reproducer.html">صياغة مُكرِّر بسيط لـ scikit-learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">تطوير مقدرات scikit-learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips.html">نصائح وحيل للمطورين</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">أدوات مساعدة للمطورين</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">كيفية التحسين من أجل السرعة</a></li>
<li class="toctree-l1"><a class="reference internal" href="cython.html">أفضل ممارسات Cython والاتفاقيات والمعرفة</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_installation.html">تثبيت نسخة التطوير من scikit-learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="bug_triaging.html">تصنيف الأخطاء ومعالجة المشكلات</a></li>
<li class="toctree-l1"><a class="reference internal" href="maintainer.html">معلومات المسؤول</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">التطوير باستخدام واجهة برمجة تطبيقات تصور البيانات</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">دليل المطورين</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">كيفية التحسين من أجل السرعة</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="performance-howto">
<span id="id1"></span><h1>كيفية التحسين من أجل السرعة<a class="headerlink" href="#performance-howto" title="Link to this heading">#</a></h1>
<p>يقدم ما يلي بعض الإرشادات العملية لمساعدتك في كتابة تعليمات برمجية فعالة
لمشروع scikit-learn.</p>
<div class="admonition note">
<p class="admonition-title">ملاحظة</p>
<p>على الرغم من أنه من المفيد دائمًا تنميط التعليمات البرمجية الخاصة بك للتحقق من
<strong>افتراضات الأداء</strong>، يُوصى بشدة أيضًا
بـ <strong>مراجعة الأدبيات</strong> للتأكد من أن الخوارزمية المُنفذة
هي أحدث ما توصلت إليه التكنولوجيا للمهمة قبل الاستثمار في تحسين التنفيذ
المُكلف.</p>
<p>مرارًا وتكرارًا، أصبحت ساعات الجهود المبذولة في تحسين تفاصيل التنفيذ
المعقدة غير ذات صلة باكتشاف <strong>حيل خوارزمية</strong> بسيطة لاحقًا،
أو باستخدام خوارزمية أخرى
أكثر ملاءمة للمشكلة تمامًا.</p>
<p>يقدم القسم <a class="reference internal" href="#warm-restarts"><span class="std std-ref">خدعة خوارزمية بسيطة: عمليات إعادة التشغيل الدافئة</span></a> مثالاً على إحدى هذه الحيل.</p>
</div>
<section id="python-cython-c-c">
<h2>Python أو Cython أو C/C++؟<a class="headerlink" href="#python-cython-c-c" title="Link to this heading">#</a></h2>
<p>بشكل عام، يؤكد مشروع scikit-learn على <strong>قابلية قراءة</strong>
شفرة المصدر لتسهيل على مستخدمي المشروع الغوص في
شفرة المصدر لفهم كيفية تصرف الخوارزمية على بياناتهم
ولكن أيضًا لسهولة الصيانة (من قبل المطورين).</p>
<p>عند تنفيذ خوارزمية جديدة، يُوصى <strong>بالبدء
بتنفيذها في Python باستخدام Numpy و Scipy</strong> عن طريق الحرص على تجنب
كود التكرار باستخدام التعابير الاصطلاحية المتجهة لهذه المكتبات. من الناحية العملية،
هذا يعني محاولة <strong>استبدال أي حلقات for متداخلة باستدعاءات
لأساليب مصفوفة Numpy المكافئة</strong>. الهدف هو تجنب إضاعة وحدة المعالجة المركزية للوقت في
مترجم Python بدلاً من معالجة الأرقام لتناسب نموذجك الإحصائي.
من الجيد عمومًا مراعاة نصائح أداء NumPy و SciPy:
<a class="reference external" href="https://scipy.github.io/old-wiki/pages/PerformanceTips">https://scipy.github.io/old-wiki/pages/PerformanceTips</a></p>
<p>ومع ذلك، في بعض الأحيان لا يمكن التعبير عن الخوارزمية بكفاءة في كود
Numpy متجه بسيط. في هذه الحالة، فإن الاستراتيجية المُوصى بها هي
التالي:</p>
<ol class="arabic simple">
<li><p><strong>نمِّط</strong> تنفيذ Python للعثور على الاختناق الرئيسي و
اعزله في <strong>دالة مستوى وحدة مخصصة</strong>. سيتم
إعادة تنفيذ هذه الدالة كوحدة نمطية ملحق مُجمَّعة.</p></li>
<li><p>إذا كان هناك تنفيذ <strong>C/C++</strong> جيد الصيانة BSD أو MIT
لنفس الخوارزمية التي ليست كبيرة جدًا، فيمكنك كتابة
<strong>مغلِّف Cython</strong> لها وتضمين نسخة من شفرة المصدر
للمكتبة في شجرة مصدر scikit-learn: يتم استخدام هذه الاستراتيجية
للفئات <a class="reference internal" href="../modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC" title="sklearn.svm.LinearSVC"><code class="xref py py-class docutils literal notranslate"><span class="pre">svm.LinearSVC</span></code></a> و <a class="reference internal" href="../modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" title="sklearn.svm.SVC"><code class="xref py py-class docutils literal notranslate"><span class="pre">svm.SVC</span></code></a> و
<a class="reference internal" href="../modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model.LogisticRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">linear_model.LogisticRegression</span></code></a> (مغلِّفات لـ liblinear
و libsvm).</p></li>
<li><p>خلاف ذلك، اكتب إصدارًا مُحسَّنًا من دالة Python باستخدام
<strong>Cython</strong> مباشرةً. تُستخدم هذه الاستراتيجية
للفئات <a class="reference internal" href="../modules/generated/sklearn.linear_model.ElasticNet.html#sklearn.linear_model.ElasticNet" title="sklearn.linear_model.ElasticNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">linear_model.ElasticNet</span></code></a> و
<a class="reference internal" href="../modules/generated/sklearn.linear_model.SGDClassifier.html#sklearn.linear_model.SGDClassifier" title="sklearn.linear_model.SGDClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">linear_model.SGDClassifier</span></code></a> على سبيل المثال.</p></li>
<li><p><strong>انقل إصدار Python للدالة في الاختبارات</strong> و
استخدمه للتحقق من أن نتائج الملحق المُجمَّع تتوافق
مع المعيار الذهبي، إصدار Python سهل التصحيح.</p></li>
<li><p>بمجرد تحسين الشفرة (وليس مجرد نقطة اختناق يمكن اكتشافها بواسطة
التنميط)، تحقق مما إذا كان من الممكن الحصول على <strong>توازي خشن الحبيبات</strong>
مناسب لـ <strong>التعددية المعالجة</strong> باستخدام
فئة <code class="docutils literal notranslate"><span class="pre">joblib.Parallel</span></code>.</p></li>
</ol>
</section>
<section id="python">
<span id="profiling-python-code"></span><h2>تنميط كود Python<a class="headerlink" href="#python" title="Link to this heading">#</a></h2>
<p>من أجل تنميط كود Python، نوصي بكتابة برنامج نصي يقوم
بتحميل بياناتك وإعدادها ثم استخدام مُنمِّط IPython المُدمج
لاستكشاف الجزء ذي الصلة من الشفرة بشكل تفاعلي.</p>
<p>لنفترض أننا نريد تنميط وحدة عامل المصفوفة غير السالب
لـ scikit-learn. لنقم بإعداد جلسة IPython جديدة وتحميل مجموعة بيانات الأرقام
كما في المثال <a class="reference internal" href="../auto_examples/classification/plot_digits_classification.html#sphx-glr-auto-examples-classification-plot-digits-classification-py"><span class="std std-ref">Recognizing hand-written digits</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">NMF</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">X</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>قبل بدء جلسة التنميط والمشاركة في تكرارات التحسين
المؤقتة، من المهم قياس إجمالي وقت التنفيذ
للدالة التي نريد تحسينها دون أي نوع من النفقات العامة للمُنمِّط
وحفظها في مكان ما للرجوع إليها لاحقًا:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">NMF</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="mi">1</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">1.7</span> <span class="n">s</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
<p>لإلقاء نظرة على ملف تعريف الأداء العام باستخدام أمر <code class="docutils literal notranslate"><span class="pre">%prun</span></code>
السحري:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="o">%</span><span class="n">prun</span> <span class="o">-</span><span class="n">l</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span> <span class="n">NMF</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
         <span class="mi">14496</span> <span class="n">استدعاء</span> <span class="n">دالة</span> <span class="n">في</span> <span class="mf">1.682</span> <span class="n">ثانية</span> <span class="n">لوحدة</span> <span class="n">المعالجة</span> <span class="n">المركزية</span>

   <span class="n">مرتبة</span> <span class="n">حسب</span><span class="p">:</span> <span class="n">الوقت</span> <span class="n">الداخلي</span>
   <span class="n">تم</span> <span class="n">تقليص</span> <span class="n">القائمة</span> <span class="n">من</span> <span class="mi">90</span> <span class="n">إلى</span> <span class="mi">9</span> <span class="n">بسبب</span> <span class="n">التقييد</span> <span class="o">&lt;</span><span class="s1">&#39;nmf.py&#39;</span><span class="o">&gt;</span>

   <span class="n">ncalls</span>  <span class="n">tottime</span>  <span class="n">percall</span>  <span class="n">cumtime</span>  <span class="n">percall</span> <span class="n">filename</span><span class="p">:</span><span class="n">lineno</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
       <span class="mi">36</span>    <span class="mf">0.609</span>    <span class="mf">0.017</span>    <span class="mf">1.499</span>    <span class="mf">0.042</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">151</span><span class="p">(</span><span class="n">_nls_subproblem</span><span class="p">)</span>
     <span class="mi">1263</span>    <span class="mf">0.157</span>    <span class="mf">0.000</span>    <span class="mf">0.157</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">(</span><span class="n">_pos</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.053</span>    <span class="mf">0.053</span>    <span class="mf">1.681</span>    <span class="mf">1.681</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">352</span><span class="p">(</span><span class="n">fit_transform</span><span class="p">)</span>
      <span class="mi">673</span>    <span class="mf">0.008</span>    <span class="mf">0.000</span>    <span class="mf">0.057</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">28</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.006</span>    <span class="mf">0.006</span>    <span class="mf">0.047</span>    <span class="mf">0.047</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">42</span><span class="p">(</span><span class="n">_initialize_nmf</span><span class="p">)</span>
       <span class="mi">36</span>    <span class="mf">0.001</span>    <span class="mf">0.000</span>    <span class="mf">0.010</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">36</span><span class="p">(</span><span class="n">_sparseness</span><span class="p">)</span>
       <span class="mi">30</span>    <span class="mf">0.001</span>    <span class="mf">0.000</span>    <span class="mf">0.001</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">23</span><span class="p">(</span><span class="n">_neg</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">337</span><span class="p">(</span><span class="fm">__init__</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">1.681</span>    <span class="mf">1.681</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">461</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</pre></div>
</div>
<p>عمود <code class="docutils literal notranslate"><span class="pre">tottime</span></code> هو الأكثر إثارة للاهتمام: فهو يعطي إجمالي الوقت الذي تم قضاؤه
في تنفيذ شفرة دالة معينة مع تجاهل الوقت الذي تم قضاؤه في تنفيذ
الدوال الفرعية. يتم إعطاء إجمالي الوقت الحقيقي (الشفرة المحلية + استدعاءات الدوال الفرعية) بواسطة
عمود <code class="docutils literal notranslate"><span class="pre">cumtime</span></code>.</p>
<p>لاحظ استخدام <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">nmf.py</span></code> الذي يقصر الإخراج على الأسطر التي
تحتوي على سلسلة &quot;nmf.py&quot;. هذا مفيد لإلقاء نظرة سريعة على النقطة
الساخنة لوحدة nmf Python نفسها مع تجاهل أي شيء آخر.</p>
<p>فيما يلي بداية ناتج نفس الأمر بدون عامل تصفية <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">nmf.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">%</span><span class="n">prun</span> <span class="n">NMF</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
         <span class="mi">16159</span> <span class="n">استدعاء</span> <span class="n">دالة</span> <span class="n">في</span> <span class="mf">1.840</span> <span class="n">ثانية</span> <span class="n">لوحدة</span> <span class="n">المعالجة</span> <span class="n">المركزية</span>

   <span class="n">مرتبة</span> <span class="n">حسب</span><span class="p">:</span> <span class="n">الوقت</span> <span class="n">الداخلي</span>

   <span class="n">ncalls</span>  <span class="n">tottime</span>  <span class="n">percall</span>  <span class="n">cumtime</span>  <span class="n">percall</span> <span class="n">filename</span><span class="p">:</span><span class="n">lineno</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
     <span class="mi">2833</span>    <span class="mf">0.653</span>    <span class="mf">0.000</span>    <span class="mf">0.653</span>    <span class="mf">0.000</span> <span class="p">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_dotblas</span><span class="o">.</span><span class="n">dot</span><span class="p">}</span>
       <span class="mi">46</span>    <span class="mf">0.651</span>    <span class="mf">0.014</span>    <span class="mf">1.636</span>    <span class="mf">0.036</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">151</span><span class="p">(</span><span class="n">_nls_subproblem</span><span class="p">)</span>
     <span class="mi">1397</span>    <span class="mf">0.171</span>    <span class="mf">0.000</span>    <span class="mf">0.171</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">18</span><span class="p">(</span><span class="n">_pos</span><span class="p">)</span>
     <span class="mi">2780</span>    <span class="mf">0.167</span>    <span class="mf">0.000</span>    <span class="mf">0.167</span>    <span class="mf">0.000</span> <span class="p">{</span><span class="n">method</span> <span class="s1">&#39;sum&#39;</span> <span class="n">of</span> <span class="s1">&#39;numpy.ndarray&#39;</span> <span class="n">objects</span><span class="p">}</span>
        <span class="mi">1</span>    <span class="mf">0.064</span>    <span class="mf">0.064</span>    <span class="mf">1.840</span>    <span class="mf">1.840</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">352</span><span class="p">(</span><span class="n">fit_transform</span><span class="p">)</span>
     <span class="mi">1542</span>    <span class="mf">0.043</span>    <span class="mf">0.000</span>    <span class="mf">0.043</span>    <span class="mf">0.000</span> <span class="p">{</span><span class="n">method</span> <span class="s1">&#39;flatten&#39;</span> <span class="n">of</span> <span class="s1">&#39;numpy.ndarray&#39;</span> <span class="n">objects</span><span class="p">}</span>
      <span class="mi">337</span>    <span class="mf">0.019</span>    <span class="mf">0.000</span>    <span class="mf">0.019</span>    <span class="mf">0.000</span> <span class="p">{</span><span class="n">method</span> <span class="s1">&#39;all&#39;</span> <span class="n">of</span> <span class="s1">&#39;numpy.ndarray&#39;</span> <span class="n">objects</span><span class="p">}</span>
     <span class="mi">2734</span>    <span class="mf">0.011</span>    <span class="mf">0.000</span>    <span class="mf">0.181</span>    <span class="mf">0.000</span> <span class="n">fromnumeric</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1185</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span>
        <span class="mi">2</span>    <span class="mf">0.010</span>    <span class="mf">0.005</span>    <span class="mf">0.010</span>    <span class="mf">0.005</span> <span class="p">{</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lapack_lite</span><span class="o">.</span><span class="n">dgesdd</span><span class="p">}</span>
      <span class="mi">748</span>    <span class="mf">0.009</span>    <span class="mf">0.000</span>    <span class="mf">0.065</span>    <span class="mf">0.000</span> <span class="n">nmf</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">28</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>تُظهر النتائج أعلاه أن التنفيذ يهيمن عليه إلى حد كبير
عمليات حاصل الضرب النقطي (المفوضة إلى blas). ومن ثم، ربما لا
يوجد مكسب كبير متوقع من خلال إعادة كتابة هذه الشفرة في Cython أو C/C++: في
هذه الحالة، من إجمالي وقت التنفيذ البالغ 1.7 ثانية، يتم قضاء ما يقرب من 0.7 ثانية
في التعليمات البرمجية المُجمَّعة التي يمكننا اعتبارها مثالية. من خلال إعادة كتابة بقية
كود Python بافتراض أنه يمكننا تحقيق زيادة بنسبة 1000٪ في هذا الجزء
(وهو أمر غير مرجح للغاية نظرًا لضحالة حلقات Python)،
لن نحصل على أكثر من 2.4x تسريع عالميًا.</p>
<p>ومن ثم، لا يمكن تحقيق تحسينات كبيرة إلا من خلال <strong>التحسينات
الخوارزمية</strong> في هذا المثال المعين (على سبيل المثال، محاولة العثور على عملية
مُكلفة وغير مجدية لتجنب حسابها بدلاً من
محاولة تحسين تنفيذها).</p>
<p>مع ذلك، لا يزال من المثير للاهتمام التحقق مما يحدث داخل
دالة <code class="docutils literal notranslate"><span class="pre">_nls_subproblem</span></code> التي تُعد النقطة الساخنة إذا أخذنا في الاعتبار
كود Python فقط: فهي تستغرق حوالي 100٪ من الوقت المُتراكم للوحدة. من أجل
فهم ملف تعريف هذه الدالة المحددة بشكل أفضل، دعنا
نُثبِّت <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code> ونوصله بـ IPython:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><style type="text/css">
span.prompt1:before {
  content: "$ ";
}
</style><span class="prompt1">pip<span class="w"> </span>install<span class="w"> </span>line_profiler</span>
</pre></div></div><p><strong>ضمن IPython 0.13+</strong>، قم أولاً بإنشاء ملف تعريف تكوين:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ipython<span class="w"> </span>profile<span class="w"> </span>create</span>
</pre></div></div><p>ثم سجِّل امتداد line_profiler في
<code class="docutils literal notranslate"><span class="pre">~/.ipython/profile_default/ipython_config.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">TerminalIPythonApp</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;line_profiler&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">InteractiveShellApp</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;line_profiler&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>سيؤدي هذا إلى تسجيل الأمر السحري <code class="docutils literal notranslate"><span class="pre">%lprun</span></code> في تطبيق محطة IPython والواجهات الأمامية الأخرى مثل qtconsole ودفتر الملاحظات.</p>
<p>الآن أعد تشغيل IPython ودعنا نستخدم هذه الأداة الجديدة:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>In [1]: from sklearn.datasets import load_digits

In [2]: from sklearn.decomposition import NMF
  ... : from sklearn.decomposition._nmf import _nls_subproblem

In [3]: X, _ = load_digits(return_X_y=True)

In [4]: %lprun -f _nls_subproblem NMF(n_components=16, tol=1e-2).fit(X)
وحدة المؤقت: 1e-06 ثانية

الملف: sklearn/decomposition/nmf.py
الدالة: _nls_subproblem في السطر 137
إجمالي الوقت: 1.73153 ثانية

رقم السطر      الزيارات        الوقت  لكل زيارة   ٪ الوقت  محتويات السطر
===============================================================================
   137                                           def _nls_subproblem(V, W, H_init, tol, max_iter):
   138                                               &quot;&quot;&quot;عامل المربعات الصغرى غير السالب
   ...
   170                                               &quot;&quot;&quot;
   171        48         5863    122.1      0.3      if (H_init &lt; 0).any():
   172                                                   raise ValueError(&quot;Negative values in H_init passed to NLS solver.&quot;)
   173
   174        48          139      2.9      0.0      H = H_init
   175        48       112141   2336.3      5.8      WtV = np.dot(W.T, V)
   176        48        16144    336.3      0.8      WtW = np.dot(W.T, W)
   177
   178                                               # القيم مُبررة في الورقة
   179        48          144      3.0      0.0      alpha = 1
   180        48          113      2.4      0.0      beta = 0.1
   181       638         1880      2.9      0.1      for n_iter in range(1, max_iter + 1):
   182       638       195133    305.9     10.2          grad = np.dot(WtW, H) - WtV
   183       638       495761    777.1     25.9          proj_gradient = norm(grad[np.logical_or(grad &lt; 0, H &gt; 0)])
   184       638         2449      3.8      0.1          if proj_gradient &lt; tol:
   185        48          130      2.7      0.0              break
   186
   187      1474         4474      3.0      0.2          for inner_iter in range(1, 20):
   188      1474        83833     56.9      4.4              Hn = H - alpha * grad
   189                                                       # Hn = np.where(Hn &gt; 0, Hn, 0)
   190      1474       194239    131.8     10.1              Hn = _pos(Hn)
   191      1474        48858     33.1      2.5              d = Hn - H
   192      1474       150407    102.0      7.8              gradd = np.sum(grad * d)
   193      1474       515390    349.7     26.9              dQd = np.sum(np.dot(WtW, d) * d)
   ...
</pre></div>
</div>
<p>من خلال النظر إلى القيم العليا لعمود <code class="docutils literal notranslate"><span class="pre">٪</span> <span class="pre">Time</span></code>، من السهل حقًا
تحديد التعبيرات الأكثر تكلفة التي تستحق عناية إضافية.</p>
</section>
<section id="id2">
<h2>تنميط استخدام الذاكرة<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>يمكنك تحليل استخدام الذاكرة لأي كود Python بالتفصيل بمساعدة
<a class="reference external" href="https://pypi.org/project/memory_profiler/">memory_profiler</a>. أولاً،
قم بتثبيت أحدث إصدار:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>memory_profiler</span>
</pre></div></div><p>ثم قم بإعداد السحر بطريقة مشابهة لـ <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code>.</p>
<p><strong>ضمن IPython 0.11+</strong>، قم أولاً بإنشاء ملف تعريف تكوين:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1">ipython<span class="w"> </span>profile<span class="w"> </span>create</span>
</pre></div></div><p>ثم سجِّل الامتداد في
<code class="docutils literal notranslate"><span class="pre">~/.ipython/profile_default/ipython_config.py</span></code>
جنبًا إلى جنب مع مُنمِّط الخط:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">TerminalIPythonApp</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;memory_profiler&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">InteractiveShellApp</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;memory_profiler&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>سيؤدي هذا إلى تسجيل الأوامر السحرية <code class="docutils literal notranslate"><span class="pre">%memit</span></code> و <code class="docutils literal notranslate"><span class="pre">%mprun</span></code> في
تطبيق محطة IPython والواجهات الأمامية الأخرى مثل qtconsole و دفتر الملاحظات.</p>
<p><code class="docutils literal notranslate"><span class="pre">%mprun</span></code> مفيد لفحص استخدام الذاكرة للدوال الرئيسية
في برنامجك سطرًا بسطر. إنه مشابه جدًا لـ <code class="docutils literal notranslate"><span class="pre">%lprun</span></code>، الذي تمت مناقشته في
القسم السابق. على سبيل المثال، من دليل <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code> <code class="docutils literal notranslate"><span class="pre">examples</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">example</span> <span class="kn">import</span> <span class="n">my_func</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">%</span><span class="n">mprun</span> <span class="o">-</span><span class="n">f</span> <span class="n">my_func</span> <span class="n">my_func</span><span class="p">()</span>
<span class="n">اسم</span> <span class="n">الملف</span><span class="p">:</span> <span class="n">example</span><span class="o">.</span><span class="n">py</span>

<span class="n">رقم</span> <span class="n">السطر</span>    <span class="n">استخدام</span> <span class="n">الذاكرة</span>  <span class="n">الزيادة</span>   <span class="n">محتويات</span> <span class="n">السطر</span>
<span class="o">==========================================================</span>
     <span class="mi">3</span>                           <span class="nd">@profile</span>
     <span class="mi">4</span>      <span class="mf">5.97</span> <span class="n">MB</span>    <span class="mf">0.00</span> <span class="n">MB</span>   <span class="k">def</span> <span class="nf">my_func</span><span class="p">():</span>
     <span class="mi">5</span>     <span class="mf">13.61</span> <span class="n">MB</span>    <span class="mf">7.64</span> <span class="n">MB</span>       <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="mi">6</span><span class="p">)</span>
     <span class="mi">6</span>    <span class="mf">166.20</span> <span class="n">MB</span>  <span class="mf">152.59</span> <span class="n">MB</span>       <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">7</span><span class="p">)</span>
     <span class="mi">7</span>     <span class="mf">13.61</span> <span class="n">MB</span> <span class="o">-</span><span class="mf">152.59</span> <span class="n">MB</span>       <span class="k">del</span> <span class="n">b</span>
     <span class="mi">8</span>     <span class="mf">13.61</span> <span class="n">MB</span>    <span class="mf">0.00</span> <span class="n">MB</span>       <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<p>أمر سحري مفيد آخر يُحدده <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code> هو <code class="docutils literal notranslate"><span class="pre">%memit</span></code>، وهو
مُشابه لـ <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>. يمكن استخدامه على النحو التالي:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="o">%</span><span class="n">memit</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">1e7</span><span class="p">)</span>
<span class="n">الحد</span> <span class="n">الأقصى</span> <span class="n">من</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">76.402344</span> <span class="n">ميغابايت</span> <span class="n">لكل</span> <span class="n">حلقة</span>
</pre></div>
</div>
<p>لمزيد من التفاصيل، انظر سلاسل الوثائق الخاصة بالسحر، باستخدام <code class="docutils literal notranslate"><span class="pre">%memit؟</span></code> و
<code class="docutils literal notranslate"><span class="pre">%mprun؟</span></code>.</p>
</section>
<section id="cython">
<h2>استخدام Cython<a class="headerlink" href="#cython" title="Link to this heading">#</a></h2>
<p>إذا كشف تنميط كود Python أن النفقات العامة لمترجم Python
أكبر بمرتبة واحدة من حيث الحجم أو أكثر من تكلفة
الحساب العددي الفعلي (على سبيل المثال، حلقات <code class="docutils literal notranslate"><span class="pre">for</span></code> على مكونات المتجه،
التقييم المتداخل للتعبير الشرطي، الحساب القياسي...)، فمن
المناسب استخراج جزء النقطة الساخنة من الشفرة كـ
دالة مستقلة في ملف <code class="docutils literal notranslate"><span class="pre">.pyx</span></code>، وإضافة إعلانات النوع الثابت
ثم استخدام Cython لإنشاء برنامج C مناسب ليتم تجميعه كـ
وحدة نمطية ملحق Python.</p>
<p>تحتوي <a class="reference external" href="http://docs.cython.org/">وثائق Cython</a> على برنامج تعليمي ودليل
مرجعي لتطوير مثل هذه الوحدة.
لمزيد من المعلومات حول التطوير في Cython لـ scikit-learn، انظر <a class="reference internal" href="cython.html#cython"><span class="std std-ref">أفضل ممارسات Cython والاتفاقيات والمعرفة</span></a>.</p>
</section>
<section id="profiling-compiled-extension">
<span id="id4"></span><h2>تنميط الملحقات المُجمَّعة<a class="headerlink" href="#profiling-compiled-extension" title="Link to this heading">#</a></h2>
<p>عند العمل مع الملحقات المُجمَّعة (مكتوبة بلغة C/C++ مع غلاف أو
مباشرة كملحق Cython)، يكون مُنمِّط Python الافتراضي عديم الفائدة:
نحن بحاجة إلى أداة مخصصة لاستقصاء ما يحدث داخل
الملحق المُجمَّع نفسه.</p>
<section id="yep-gperftools">
<h3>استخدام yep و gperftools<a class="headerlink" href="#yep-gperftools" title="Link to this heading">#</a></h3>
<p>تنميط سهل بدون خيارات تجميع خاصة استخدم yep:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/yep/">https://pypi.org/project/yep/</a></p></li>
<li><p><a class="reference external" href="https://fa.bianp.net/blog/2011/a-profiler-for-python-extensions">https://fa.bianp.net/blog/2011/a-profiler-for-python-extensions</a></p></li>
</ul>
</section>
<section id="gdb">
<h3>استخدام مُصحِّح أخطاء، gdb<a class="headerlink" href="#gdb" title="Link to this heading">#</a></h3>
<ul>
<li><p>من المفيد استخدام <code class="docutils literal notranslate"><span class="pre">gdb</span></code> لتصحيح الأخطاء. للقيام بذلك، يجب على المرء استخدام
مترجم Python تم تصميمه مع دعم التصحيح (رموز التصحيح والتحسين
المناسب). لإنشاء بيئة conda جديدة (التي قد تحتاج
إلى إلغاء تنشيطها وإعادة تنشيطها بعد البناء/التثبيت) باستخدام مترجم
CPython مبني من المصدر:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/python/cpython.git
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>debug-scikit-dev
conda<span class="w"> </span>activate<span class="w"> </span>debug-scikit-dev
<span class="nb">cd</span><span class="w"> </span>cpython
mkdir<span class="w"> </span>debug
<span class="nb">cd</span><span class="w"> </span>debug
../configure<span class="w"> </span>--prefix<span class="o">=</span><span class="nv">$CONDA_PREFIX</span><span class="w"> </span>--with-pydebug
make<span class="w"> </span><span class="nv">EXTRA_CFLAGS</span><span class="o">=</span><span class="s1">&#39;-DPy_DEBUG&#39;</span><span class="w"> </span>-j&lt;num_cores&gt;
make<span class="w"> </span>install
</pre></div>
</div>
</li>
</ul>
</section>
<section id="gprof">
<h3>استخدام gprof<a class="headerlink" href="#gprof" title="Link to this heading">#</a></h3>
<p>من أجل تنميط ملحقات Python المُجمَّعة، يمكن للمرء استخدام <code class="docutils literal notranslate"><span class="pre">gprof</span></code>
بعد إعادة تجميع المشروع باستخدام <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">-pg</span></code> واستخدام
متغير <code class="docutils literal notranslate"><span class="pre">python-dbg</span></code> للمترجم على debian / ubuntu: ومع ذلك
يتطلب هذا النهج أيضًا إعادة تجميع <code class="docutils literal notranslate"><span class="pre">numpy</span></code> و <code class="docutils literal notranslate"><span class="pre">scipy</span></code>
باستخدام <code class="docutils literal notranslate"><span class="pre">-pg</span></code> وهو أمر معقد إلى حد ما لجعله يعمل.</p>
<p>لحسن الحظ، يوجد مُنمِّطان بديلان لا يتطلبان منك
إعادة تجميع كل شيء.</p>
</section>
<section id="valgrind-callgrind-kcachegrind">
<h3>استخدام valgrind / callgrind / kcachegrind<a class="headerlink" href="#valgrind-callgrind-kcachegrind" title="Link to this heading">#</a></h3>
<section id="kcachegrind">
<h4>kcachegrind<a class="headerlink" href="#kcachegrind" title="Link to this heading">#</a></h4>
<p>يمكن استخدام <code class="docutils literal notranslate"><span class="pre">yep</span></code> لإنشاء تقرير تنميط.
يوفر <code class="docutils literal notranslate"><span class="pre">kcachegrind</span></code> بيئة رسومية لتصور هذا التقرير:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="c1"># تشغيل yep لتنميط بعض البرامج النصية python</span></span>
<span class="prompt1">python<span class="w"> </span>-m<span class="w"> </span>yep<span class="w"> </span>-c<span class="w"> </span>my_file.py</span>
</pre></div></div><div class="highlight-default notranslate"><div class="highlight"><pre><span class="prompt1"><span class="c1"># افتح my_file.py.callgrin باستخدام kcachegrind</span></span>
<span class="prompt1">kcachegrind<span class="w"> </span>my_file.py.prof</span>
</pre></div></div><div class="admonition note">
<p class="admonition-title">ملاحظة</p>
<p>يمكن تنفيذ <code class="docutils literal notranslate"><span class="pre">yep</span></code> مع الوسيطة <code class="docutils literal notranslate"><span class="pre">--lines</span></code> أو <code class="docutils literal notranslate"><span class="pre">-l</span></code> لتجميع
تقرير تنميط &quot;سطرًا بسطر&quot;.</p>
</div>
</section>
</section>
</section>
<section id="joblib-parallel">
<h2>التوازي متعدد النواة باستخدام <code class="docutils literal notranslate"><span class="pre">joblib.Parallel</span></code><a class="headerlink" href="#joblib-parallel" title="Link to this heading">#</a></h2>
<p>انظر <a class="reference external" href="https://joblib.readthedocs.io">وثائق joblib</a></p>
</section>
<section id="warm-restarts">
<span id="id5"></span><h2>خدعة خوارزمية بسيطة: عمليات إعادة التشغيل الدافئة<a class="headerlink" href="#warm-restarts" title="Link to this heading">#</a></h2>
<p>انظر إدخال المُصطلحات لـ <a class="reference internal" href="../glossary.html#term-warm_start"><span class="xref std std-term">warm_start</span></a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item">
<div class="prev-next-area">
    <a class="left-prev"
       href="utilities.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">السابق</p>
        <p class="prev-next-title">أدوات مساعدة للمطورين</p>
      </div>
    </a>
    <a class="right-next"
       href="cython.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">التالي</p>
        <p class="prev-next-title">أفضل ممارسات Cython والاتفاقيات والمعرفة</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>
                </footer>
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-cython-c-c">Python أو Cython أو C/C++؟</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python">تنميط كود Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">تنميط استخدام الذاكرة</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cython">استخدام Cython</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#profiling-compiled-extension">تنميط الملحقات المُجمَّعة</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#yep-gperftools">استخدام yep و gperftools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gdb">استخدام مُصحِّح أخطاء، gdb</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gprof">استخدام gprof</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#valgrind-callgrind-kcachegrind">استخدام valgrind / callgrind / kcachegrind</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#kcachegrind">kcachegrind</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joblib-parallel">التوازي متعدد النواة باستخدام <code class="docutils literal notranslate"><span class="pre">joblib.Parallel</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#warm-restarts">خدعة خوارزمية بسيطة: عمليات إعادة التشغيل الدافئة</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/developers/performance.rst.txt">
      <i class="fa-solid fa-file-lines"></i> إظهار المصدر
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2007 - 2024, scikit-learn developers (BSD License) ### Translate into Arabic Eng. Ahmed Almaghz - 2024.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>